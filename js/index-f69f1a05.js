import{n as c}from"./index-8abb1e0a.js";const l={name:"Comment",data(){return{showUtterances:!0,showTwikoo:!1,loading:!0}},computed:{currentComment:{get(){return this.$store.state.style.currentComment||"utterances"},set(t){this.$store.commit("style/setCurrentComment",t)}},utterancesOpts(){const t=this.$config.utterances.code,s=/(\w+)\s*=\s*["']([^"']+)["']/g,e=t.match(s),r={};return t.includes("async")&&(r.async=!0),e==null||e.forEach(n=>{const[a,i,o]=n.match(/(\w+)\s*=\s*["']([^"']+)["']/);r[i]=o}),r.theme=this.theme==="dark"?"github-dark":"github-light",r},theme(){return this.$store.state.style.theme}},watch:{$route(){document.querySelector(".utterances .utterances")&&document.querySelector(".utterances .utterances").remove(),this.loadAll()},theme(){const t=this.theme==="dark"?"github-dark":"github-light";document.querySelector(".utterances .utterances iframe").contentWindow.postMessage({type:"set-theme",theme:t},"https://utteranc.es")}},mounted(){this.loadAll()},methods:{installUtterances(){const t=document.createElement("script");t.async=this.utterancesOpts.async||!1,t.setAttribute("src",this.utterancesOpts.src||"https://utteranc.es/client.js"),t.setAttribute("repo",this.utterancesOpts.repo),t.setAttribute("issue-term",this.utterancesOpts.term),this.utterancesOpts.label!==""&&t.setAttribute("label",this.utterancesOpts.label),t.setAttribute("theme",this.utterancesOpts.theme),t.setAttribute("crossorigin",this.utterancesOpts.crossorigin||"anonymous"),this.$refs.utterances.appendChild(t)},installTwikoo(){twikoo.init({envId:"VITE_LEANCLOUD_ID:",el:".twikoo"})},setActiveComment(t){var s,e;if(t){t==="utterances"?(this.showUtterances=!0,this.showTwikoo=!1):t==="twikoo"&&(this.showUtterances=!1,this.showTwikoo=!0);const r=(s=this.$refs.commentsNav)==null?void 0:s.querySelectorAll("li");r==null||r.forEach(a=>{a==null||a.classList.remove("active")});const n=(e=this.$refs.commentsNav)==null?void 0:e.querySelector(`.${t}-toggle`);n==null||n.classList.add("active")}},setCurrentComment(t){if(t.target.nodeName==="LI"){const s=t.target.classList[0].split("-")[0];this.currentComment=s,this.setActiveComment(s)}},loadAll(){new Promise((t,s)=>{const e=setInterval(()=>{this.$refs.utterances?(clearInterval(e),this.loading=!1,t()):s(new Error("加载评论失败，正在重试中..."))},100)}).then(()=>{this.setActiveComment(this.currentComment),this.installUtterances(),this.installTwikoo()})}}};var u=function(){var s=this,e=s._self._c;return e("div",{staticClass:"comments"},[e("div",{staticClass:"comments-header"},[e("h2",[e("SvgIcon",{attrs:{name:"comment"}}),s._v(" 评论")],1),e("ul",{ref:"commentsNav",staticClass:"comments-nav",on:{click:s.setCurrentComment}},[e("li",{staticClass:"utterances-toggle active"},[s._v(" Utterances ")]),e("li",{staticClass:"twikoo-toggle"},[s._v(" Twikoo ")])])]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"loading"}],staticClass:"comments-body"},[e("transition",{attrs:{name:"slide"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:s.showUtterances,expression:"showUtterances"}],staticClass:"u-wrap"},[e("div",{ref:"utterances",staticClass:"utterances"})])]),e("transition",{attrs:{name:"slide"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:s.showTwikoo,expression:"showTwikoo"}],staticClass:"t-wrap"},[e("div",{staticClass:"twikoo"})])])],1)])},m=[],h=c(l,u,m,!1,null,null,null,null);const v=h.exports;export{v as C};
